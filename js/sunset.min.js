(function(f){f.fn.pmSunset=function(){var B,C,G=2*Math.PI,l=100*G>>0;C=[];for(var d=-l;d<l;d++)C[d]=Math.sin(0.01*d);B=[];for(d=-l;d<l;d++)B[d]=Math.cos(0.01*d);var H=new Image;H.src="images/postrain_small.jpg";var I=0;return this.each(function(){function d(){g=1;m=0;e=~~(b.width()/g);e=e+e%2+2;n=~~(b.height()/g)+2;b.css("overflow","hidden");a.setAttribute("overflow","hidden");a.setAttribute("width",e+(e>>1));a.setAttribute("height",n);f(a).css("position","relative");f(a).css("left","-"+(b.width()>>
2)+"px");f(a).css("width",b.width()+(b.width()>>1)+"px");f(a).css("height",b.height());w=e>>2;J=w+e;r=0.67*n>>0;x=a.width>>4;rCA=3E-4*(n/3);k=h.getImageData(0,r,a.width,a.height-r);f("#realtimeinfo").html("Actual resolution: "+b.width()+"px x "+b.height()+"px, scaled: "+g+"x, &lt;canvas&gt; resolution: "+e+" x "+n);D=(new Date).getTime();u=0}var a,h,e,n,s,r,m=0,g,k,w,J,x,y,p,z=0,q=0,t,E,D=0,u=0,b=f(this),F=document.createElement("canvas");a=this.appendChild(F);h=a.getContext("2d");x=a.width>>4;b.mousemove(function(c){z=
c.clientX-b.offset().left;q=c.clientY-b.offset().top;a&&(t=z/g+a.width/6,E=q/g,I=-(t>>2)+(t>>3),s=h.createRadialGradient(t,E,0,t,q/g,x),s.addColorStop(0,"rgba(140,120,250,1)"),s.addColorStop(0.5,"rgba(75,60,120,1)"),s.addColorStop(1,"rgba(75,60,120,0)"))});d();setInterval(function(){if(!a)return!1;0===m&&d();var c,b;r=0.67*n>>0;a.setAttribute("width",e+(e>>1));a.setAttribute("height",n);m<l?m++:m=1;h.drawImage(H,I,0);s&&(h.fillStyle=s,h.beginPath(),h.arc(t,E,x,0,G,!0),h.closePath(),h.fill());c=h.getImageData(0,
0,a.width,r);var f=c.data,g=c.width,q=c.height-1,z=c.width<<2,F=q>>1;c=60;var L=m<<3,M=m<<3,g=g>>1;p=w<<2;for(var v=q;v>F;v--){c*=0.97;b=v*c+L;for(var K=q-v-1<<2,N=(v+(B[~~(b%l)]*K>>2))*z,O=c-(c>>4),A=w;A<J;A++)b=C[~~(((A-g)*O+M)%l)]*K>>2,y=N+(A+b<<2),k.data[p++]=f[y++],k.data[p++]=f[y++],k.data[p++]=f[y++],k.data[p++]=255;p+=e<<1}h.putImageData(k,0,r,0,0,k.width,k.height);u++;200<u&&(document.getElementById("fps").innerHTML="FPS: "+~~(u/(((new Date).getTime()-D)/1E3)),u=0,D=(new Date).getTime())},
1)})}})(jQuery);
